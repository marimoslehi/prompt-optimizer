// backend/my-app/prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String       @id @default(cuid())
  email       String       @unique
  password    String?      // Made optional for OAuth users
  googleId    String?      @unique // Google OAuth ID
  firstName   String?
  lastName    String?
  company     String?
  role        String?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  promptTests PromptTest[]
  
  @@map("users")
}

model PromptTest {
  id             String        @id @default(cuid())
  userId         String
  promptText     String
  modelsSelected String[]
  totalCost      Float         @default(0)
  totalTokens    Int           @default(0)
  responseTimeMs Int           @default(0)
  createdAt      DateTime      @default(now())
  modelResults   ModelResult[]
  user           User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("prompt_tests")
}

model ModelResult {
  id             String     @id @default(cuid())
  testId         String
  modelId        String
  modelName      String
  responseText   String?
  tokensUsed     Int        @default(0)
  cost           Float      @default(0)
  responseTimeMs Int        @default(0)
  qualityScore   Int        @default(0)
  createdAt      DateTime   @default(now())
  promptTest     PromptTest @relation(fields: [testId], references: [id], onDelete: Cascade)
  
  @@map("model_results")
}